# Overview

這篇介紹如何創建API入口，和分層架構。  

## 後端文件(Java Spring Boot) - RESTful API

### 整體架構

1. 控制層：負責處理HTTPS請求，將請求屬據傳遞給業務層並返回結果給前端。
 - "MyController.java"
2. 業務層：負責處理具體的業務邏輯，調用數據訪問層來操作數據。
 - "MySql.java"
3. 數據訪問層：負責與數據庫連結，執行SQL語句來讀寫數據。
 - "SqlControl.java"，"SqlDAO.java"
 
### 分層架構優點

1. 清晰的責任劃分：每個層負責不同的職責，控制層處理請求，業務層處理邏輯，數據訪問層處理數據庫操作。
2. 可維護性：各層之間相互獨立，修改一層的代碼不會影響其他層。
3. 可重用性：例如MySql.Login方法可以在不同的方法中被調用。

### 創建Controllers為RESTful API接口

 - 創建"MyController.java"，處理登入請求。

``` java
@RestController
public class MyController {
    
    @PostMapping("/login")
    public ResponseEntity<String> login(@RequestBody User user) {
        ...
        String result = MySql.Login(acc, pwd);
        return ResponseEntity.ok(result);
    }
}
```

### 處理業務邏輯

 - "MySql.java"主要負責與數據庫連接。
 
 ```java
 public class MySql {
    
    private static final String url = "jdbc:mysql://xxx/tableName";
    private static final String username = DB_name;
    private static final String password = DB_pwd;

    public static String Login(String acc, String pwd) {
        try (Connection conn = DriverManager.getConnection(url, username, password)) {
            SqlControl sqlControl = new SqlControl(conn);
            String result = sqlControl.findAccount(acc, pwd);
            ...
        } catch (SQLException e) {
            e.printStackTrace();
            return "Database connection error";
        }
    }
}
 ```
 
 ### 數據庫訪問
 
 - "SqlControl.java"實作"SqlManager"介面，負責數據庫操作。
 
 ```java
 public class SqlControl implements SqlManager {    
    private Connection conn;
    public SqlControl(Connection conn) {
        this.conn = conn;
    }
    @Override
    public String findAccount(String acc, String pwd) {
        User userInfo = sqlDAO.getEmailAcc(acc);
        ...驗證密碼等邏輯
    }
}
 ```
 
 - "SqlDAO.java"實現SQL查詢，從數據庫中搜尋用戶訊息。
 
 ```java
 public class SqlDAO {
    
    public User getEmailAcc(String email) {
        String sql = "SELECT Username, Password FROM Users WHERE Email = ?";
        ...處理資料邏輯
    }
}
 ```
