# Overview

## 部屬後端應用

### 安裝Java

1. 首先使用putty連到AWS EC2
2. 安裝java
```sh
sudo yum update -y
sudo yum install -y java-1.8.0-openjdk
```
安裝完畢之後，打上java --version判斷是否成功安裝  

3. 執行 Java spring boot
```sh
java -jar xxx.jar
```

### 配置 Apache Server

1. 安裝 Apache
```sh
sudo yum install -y httpd
```
2. 啟動並設置 Apache 開機啟動
```sh
sudo systemctl start httpd
sudo systemctl enable httpd
```

### 使用 Apache 作為反向代理

1. 配置 Apache 作為反向代理，編輯 Apache 配置文件
```sh
<IfModule mod_ssl.c>
<VirtualHost *:443>
    ServerName xxx.com
    ServerAlias www.xxx.com
    DocumentRoot "/var/www/xxx"

    <Directory "/var/www/xxx">
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    ProxyPreserveHost On
    ProxyPass /api/v1/ http://localhost:8080/api/v1
    ProxyPassReverse /api/v1/ http://localhost:8080/api/v1/

    ProxyPass /images/v1/ http://localhost:8080/images/v1/
    ProxyPassReverse /images/v1/ http://localhost:8080/images/v1/

    ErrorLog "/var/log/httpd/xxx_error.log"
    CustomLog "/var/log/httpd/xxx_access.log" combined
Include /etc/xxx/options-ssl-apache.conf
SSLCertificateFile /etc/xxx/live/xxx.com/fullchain.pem
SSLCertificateKeyFile /etc/xxx/live/xxx.com/privkey.pem
</VirtualHost>
</IfModule>
```
 - 分離前後端: 前端靜態資源由 Apache 提供，API 請求則由後端服務處理，提升了架構的彈性與可維護性。
 - 安全性: 隱藏了後端伺服器的實際位址，減少了直接攻擊後端伺服器的風險。
 - 簡化部署: 用戶端只需要知道 Apache 伺服器的位址，不需要關心後端服務的位址和連接埠。  
  
2. 重啟 Apache 讓配置生效
```sh
sudo apachectl configtest
sudo systemctl reload httpd
sudo systemctl restart httpd
```
